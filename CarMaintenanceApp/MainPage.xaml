<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:model="clr-namespace:CarMaintenanceApp.Models"
             x:Class="CarMaintenanceApp.MainPage"
             Title="Oil Change Tracker">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="16">
            <Border Stroke="#CBD5E1" StrokeThickness="1" Padding="16">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Next Suggested Change" FontAttributes="Bold" FontSize="16" />
                    <Label Text="{Binding NextOilChangeMileage}" FontSize="22" TextColor="#0F766E" />
                </VerticalStackLayout>
            </Border>

            <Label Text="Add Oil Change Activity" FontAttributes="Bold" FontSize="18" />
            <DatePicker Date="{Binding NewDate}" />
            <Entry Text="{Binding NewOdometerMiles}" Keyboard="Numeric" Placeholder="Odometer (miles)" />
            <Editor Text="{Binding NewNotes}" AutoSize="TextChanges" Placeholder="Notes" />
            <Button Text="Add Activity" Command="{Binding AddCommand}" />

            <Label Text="Activities" FontAttributes="Bold" FontSize="18" />
            <CollectionView ItemsSource="{Binding Entries}" SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="model:OilChangeEntry">
                        <SwipeView>
                            <SwipeView.RightItems>
                                <SwipeItems Mode="Reveal">
                                    <SwipeItem
                                        Text="Delete"
                                        BackgroundColor="#DC2626"
                                        Command="{Binding BindingContext.DeleteCommand, Source={RelativeSource AncestorType={x:Type ContentPage}}}"
                                        CommandParameter="{Binding .}" />
                                </SwipeItems>
                            </SwipeView.RightItems>

                            <Border Margin="0,0,0,8" Stroke="#E2E8F0" StrokeThickness="1" Padding="12">
                                <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="*,Auto">
                                    <Label Grid.Row="0" Grid.Column="0" Text="{Binding Date, StringFormat='Date: {0:MMM dd, yyyy}'}" />
                                    <Label Grid.Row="1" Grid.Column="0" Text="{Binding OdometerMiles, StringFormat='Mileage: {0:N0} mi'}" />
                                    <Label Grid.Row="2" Grid.Column="0" Text="{Binding Notes}" LineBreakMode="WordWrap" />
                                    <Button Grid.RowSpan="3"
                                            Grid.Column="1"
                                            VerticalOptions="Center"
                                            BackgroundColor="#334155"
                                            Text="{Binding Status}"
                                            Command="{Binding BindingContext.ToggleStatusCommand, Source={RelativeSource AncestorType={x:Type ContentPage}}}"
                                            CommandParameter="{Binding .}" />
                                </Grid>
                            </Border>
                        </SwipeView>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
